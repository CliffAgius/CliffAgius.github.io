<!DOCTYPE html>
<html lang="en-gb">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Clifford Agius | CA-Software Ltd">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://cliffagius.github.io//img/Banner.png">
    <meta property="twitter:image" content="https://cliffagius.github.io//img/Banner.png" />
    

    
    <meta name="title" content="Setup Windows Terminal to run a Macro" />
    <meta property="og:title" content="Setup Windows Terminal to run a Macro" />
    <meta property="twitter:title" content="Setup Windows Terminal to run a Macro" />
    

    
    <meta name="description" content="I run a PowerShell script often to delete the OBJ/BIN folders in my Xamarin projects when things get a bit Janky, it was copy and pasting but now I have automated it with Windows Terminal...">
    <meta property="og:description" content="I run a PowerShell script often to delete the OBJ/BIN folders in my Xamarin projects when things get a bit Janky, it was copy and pasting but now I have automated it with Windows Terminal..." />
    <meta property="twitter:description" content="I run a PowerShell script often to delete the OBJ/BIN folders in my Xamarin projects when things get a bit Janky, it was copy and pasting but now I have automated it with Windows Terminal..." />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="Freelance .NET IoT Developer c# Azure CASOftware">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>Setup Windows Terminal to run a Macro-</title>

    <link rel="canonical" href="/post/windowsterminalcustommacros/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.css">

    
    
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Clifford Agius | CA-Software Ltd</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/iot">iot</a>
                        </li>
                        
                        <li>
                            <a href="/categories/xamarin">xamarin</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/speaking/">Speaking</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    
                        <li><a href="/top/flying/">Flying</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/post/windowsterminalcustommacros/2021-02-24-00-16-08.png');
        opacity: 0.6;
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="post-heading-box">
                        <div class="tags">
                            
                            <a class="tag" href="/tags/xamarin" title="Xamarin">
                                Xamarin
                            </a>
                            
                        </div>
                        <h1>Setup Windows Terminal to run a Macro</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by
                            
                            Clifford Agius | CA-Software Ltd
                            
                            on
                            Tuesday, February 23, 2021
                            
                            
                            
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#what-and-why">What and Why?</a></li>
    <li><a href="#how-do-we-manually-delete">How do we manually delete?</a>
      <ul>
        <li><a href="#powershell-command">PowerShell Command</a></li>
        <li><a href="#automating-the-powershell-command">Automating the PowerShell Command</a></li>
        <li><a href="#adding-a-macro">Adding a Macro</a></li>
      </ul>
    </li>
    <li><a href="#warning">Warning</a>
      <ul>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <h1 id="what-and-why">What and Why?</h1>
<p>I do a lot of Xamarin development for clients and when I am working away the builds sometimes fail on say Android or iOS and the reason a lot of the time is where the build system in Visual Studio has had a hiccup and the quickest and easiest way to resolve this is the Delete the Bin/OBJ folders and rebuild.  Sadly, just a Clean in Visual Studio doesn&rsquo;t delete the folders and files so doesn&rsquo;t work especially for Android so it’s a hard delete.</p>
<p>The problem is made worse by the fact that there is a Bin/OBJ folder in each of the project heads and for Xamarin this will be the Core, Android, iOS and for my projects UWP as well so that is 4 projects that you have to go into and delete the two folders.</p>
<h1 id="how-do-we-manually-delete">How do we manually delete?</h1>
<p>There is obviously an easy way of opening the File Explorer and finding the folders and clicking delete, this is time intensive and open to errors of deleting the wrong folder and really messing things up&hellip; Ask me how I know&hellip;</p>
<p>The other way is to go into Windows Terminal (My favourite terminal program) which is awesome and amazing, and you should be using it, you can read more about it <a href="https://devblogs.microsoft.com/commandline/introducing-windows-terminal/?WT.mc_id=DOP-MVP-5003764">here</a> or download for free from the Windows Store.</p>
<p>Once I have it open, I run a PowerShell script (More in a bit) to delete the folders and I cut and paste this into Terminal and then next time up arrow and enter as you do it often.</p>
<h2 id="powershell-command">PowerShell Command</h2>
<p>There are 2 versions of the command that Xamarin developers use and they both have advantages and disadvantages.</p>
<p>The first is:</p>
<h3 id="git-clean">Git Clean</h3>
<pre><code>git clean -xdf
</code></pre>
<p>This cleans all the untracked GitHub files and folders, but to break it down you can see the <a href="https://git-scm.com/docs/git-clean">docs</a> but quickly.</p>
<pre><code>x = Delete all untracked Files
d = Delete all untracked Folders
f = Force the deletion
</code></pre>
<h4 id="pro">Pro</h4>
<p>This a very powerful command and super short and easy to remember so no need to Post.</p>
<h4 id="con">Con</h4>
<p>It deletes every untracked file, so if like me you have a folder in your project with some temp design files or you have added some images but havn&rsquo;t commited them yet etc they get blown away as well.</p>
<p>Second:</p>
<h3 id="powershell-script">PowerShell Script</h3>
<p>This is a longer command that uses the power of PowerShell to delete just the Bin/Obj folders and files but leaves the rest of the project files and folders in place.  This command I got from the awesome <a href="https://montemagno.com/easily-clean-bin-obj-folders/">James Montemagno’ s blog</a>.</p>
<pre><code>Get-ChildItem .\ -include bin,obj -Recurse | foreach ($_) { remove-item $_.fullname -Force -Recurse }
</code></pre>
<h4 id="pro-1">Pro</h4>
<p>This will just delete the Bin/Obj files and folders and nothing else so it&rsquo;s not using the .gitignore or the tracked files to decide what to delete.</p>
<h4 id="con-1">Con</h4>
<p>This command is longer and not something I can remember so I used to cut and paste normally from James blog.</p>
<h2 id="automating-the-powershell-command">Automating the PowerShell Command</h2>
<p>Now we have a command and my favourite being the PowerShell script I wanted to automate this and make it quick and easy to repeat.  So being a Windows Terminal user I read that you can add your own commands and that is what I did.</p>
<p>So open Terminal and at the top, open the settings by clicking the down arrow and opening settings.</p>
<p>
  <img src="2021-02-24-00-10-13.png" alt="Windows Terminal Settings">

</p>
<p>This will open <a href="https://code.visualstudio.com/">VSCode</a> if you have it installed (Why Wouldn’t you eh!)</p>
<p>
  <img src="2021-02-24-00-13-45.png" alt="Terminal Settings in VSCode">

</p>
<p>Now you have this open scroll down and you will see where you can edit the profiles by adding other tabs or colours and fonts etc, but near the bottom (At least for me!) is a section in JSON called <code>Actions</code> and it here we want to play.</p>
<p>
  <img src="2021-02-24-00-16-08.png" alt="Actions section in the JSON file.">

</p>
<h2 id="adding-a-macro">Adding a Macro</h2>
<p>In here we can read the <a href="https://docs.microsoft.com/en-gb/windows/terminal/customize-settings/actions?WT.mc_id=DOP-MVP-5003764">Docs</a> for Windows Terminal and see that there is a cool ability to add our very own Key Binding.</p>
<p>
  <img src="2021-02-24-00-21-41.png" alt="Docs Send Input">

</p>
<p>So, reading the docs we need to add our action to <code>SendInput</code> and then the command we want to send and the Key binding to make this happen.</p>
<pre><code>// Alt + C will run the command to delete all the Bin/OBJ folders in the current project tree.

{&quot;command&quot;: { &quot;action&quot;: &quot;sendInput&quot;, &quot;input&quot;: &quot;Get-ChildItem .\\ -include bin,obj -Recurse | ForEach-Object ($_) { Remove-Item $_.FullName -Force -Recurse }&quot; }, &quot;keys&quot;: &quot;alt+c&quot; }
</code></pre>
<p>So looking at this in detail we have the <code>Command</code> and the action set to <code>sendInput</code> with the input set to out PowerShell script that we prefer and then finally I picked <code>Alt+C</code> as my binding to call the command and this goes into the Keys section.</p>
<p>Tip here is pick a key binding that isn&rsquo;t used for something already and easy to use and remember.</p>
<p>Click Save and then close/reopen Terminal (I find it doesn’t always work!) and your new binding will be live.</p>
<p>For me click <code>Alt+C</code> and the command is placed at the command prompt and I then tap <code>Enter</code> to run the command.</p>
<p>
  <img src="2021-02-24-00-26-36.png" alt="Alt&#43;C Command Run">

</p>
<p>Now all the Bin/Obj in that folder and all its subfolders are wiped away.</p>
<h1 id="warning">Warning</h1>
<p>Be careful as it&rsquo;s very easy to run this in a top-level folder and wipe the Bin/Obj folders in all your projects by mistake (Again ask me how I know!).</p>
<h2 id="conclusion">Conclusion</h2>
<p>I use this multiple times per day, and it saves me many seconds each time so over the course of a week/month I have save vital minutes of my live.  Yes..Yes&hellip; I know but it&rsquo;s all about the context switch rather than the saved time, the fact that I now after just a few weeks have the muscle memory I am not distracted from what I am doing.</p>
<p>I hope this helps someone.</p>
<p>Happy Coding!</p>


                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/xamarinioshotrestart/" data-toggle="tooltip" data-placement="top"
                            title="Setup HotRestart for iOS on Windows">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/xamarin" title="xamarin">
                            xamarin
                        </a>
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Clifford Agius | CA-Software Ltd" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:CliffordAgius@CA-Software.co.uk">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a href="https://twitter.com/CliffordAgius">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/CliffAgius">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/clifford-agius/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Clifford Agius | CA-Software Ltd 2021
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-158344868-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
